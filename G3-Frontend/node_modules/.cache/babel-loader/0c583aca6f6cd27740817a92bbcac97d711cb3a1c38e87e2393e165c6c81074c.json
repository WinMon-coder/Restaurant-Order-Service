{"ast":null,"code":"import swal from \"sweetalert2\";\nwindow.swal = swal;\nimport utils from \"@/utils/utils\";\nimport AdminSideBar from \"@/components/AdminSideBar.vue\";\nexport default {\n  components: {\n    AdminSideBar\n  },\n  data: () => ({\n    createDiscountForm: false,\n    dialog: false,\n    update_dialog: false,\n    delete_dialog: false,\n    loading: false,\n    errorAlert: false,\n    deleteDemo: {},\n    updateDemo: {},\n    createDemo: {\n      tableName: \"\"\n    },\n    discountList: [],\n    headers: [{\n      text: \"ID\",\n      align: \"start\",\n      sortable: false,\n      value: \"discountId\"\n    }, {\n      text: \"Table\",\n      value: \"tableName\"\n    }, {\n      text: \"Created Date\",\n      value: \"createdAt\"\n    }, {\n      text: \"Modified Date\",\n      value: \"updatedAt\"\n    }, {\n      text: \"Actions\",\n      value: \"actions\",\n      sortable: false\n    }]\n  }),\n  async created() {\n    await this.fetchAllDiscounts();\n  },\n  methods: {\n    // <!-- -------------****** get all table from utils.http ******-------------------------- -->\n    async fetchAllDiscounts() {\n      const response = await utils.http.get(\"/discount/list\");\n      if (response) {\n        const data = await response.json();\n        if (data) this.discountList = data;\n      } else {\n        console.log(\"sth wrong\");\n      }\n    },\n    // <!-- -------------****** save table from utils.http ******-------------------------- -->\n    async save() {\n      if (this.$refs.createDiscountForm.validate()) {\n        let tableNameCheckByOK = false;\n        const respTableNameCheck = await utils.http.get(\"/table/\" + this.createDemo.tableName.trim());\n        if (respTableNameCheck && respTableNameCheck.status == 200) {\n          const data = await respTableNameCheck.json();\n          if (data && data == true) {\n            swal.fire({\n              icon: \"error\",\n              title: \"Sorry...\",\n              text: \"Table name already exists!\"\n            });\n          } else {\n            tableNameCheckByOK = true;\n          }\n        }\n        if (tableNameCheckByOK) {\n          const resp = await utils.http.post(\"/admin/table/create\", {\n            tableName: this.createDemo.tableName\n          });\n          if (resp) {\n            await this.fetchAllTables();\n            this.dialog = false;\n            this.createDemo = {};\n          } else {\n            this.errorAlert = true;\n          }\n        }\n      }\n    },\n    // <!-- -------------****** update table from utils.http ******-------------------------- -->\n    async updateItemConfirm(id) {\n      const resp = await utils.http.put(\"/admin/table/update/\" + id, {\n        tableName: this.updateDemo.tableName\n      });\n      if (resp && resp.status === 200) {\n        await this.fetchAllTables();\n        this.update_dialog = false;\n      } else {\n        swal.fire({\n          icon: \"error\",\n          title: \"Sorry...\",\n          text: \"Table cannot update!\"\n        });\n      }\n    },\n    // <!-- -------------****** delete table from utils.http ******-------------------------- -->\n    async deleteItemConfirm(id) {\n      const resp = await utils.http.del(\"/admin/table/delete/\" + id);\n      if (resp.status == 200) {\n        await this.fetchAllTables();\n        this.delete_dialog = false;\n      }\n    },\n    // <!-- -------------******  event handelar from dialog ******-------------------------- -->\n\n    deleteItem(item) {\n      this.delete_dialog = true;\n      this.deleteDemo = item;\n    },\n    editItem(item) {\n      this.update_dialog = true;\n      this.updateDemo = Object.assign({}, item);\n      this.tableName = this.updateDemo.tableName;\n    },\n    closeUpdate() {\n      this.update_dialog = false;\n    },\n    closeDelete() {\n      this.delete_dialog = false;\n    },\n    saveCancel() {\n      this.dialog = false;\n      this.createDemo = {};\n    }\n  }\n};","map":{"version":3,"mappings":"AAuJA;AACAA;AACA;AACA;AACA;EACAC;IACAC;EACA;EACAC;IACAC;IACAC;IACAC;IACAC;IACAC;IACAC;IACAC;IACAC;IACAC;MACAC;IACA;IACAC;IACAC,UACA;MACAC;MACAC;MACAC;MACAC;IACA,GACA;MAAAH;MAAAG;IAAA,GACA;MAAAH;MAAAG;IAAA,GACA;MAAAH;MAAAG;IAAA,GACA;MAAAH;MAAAG;MAAAD;IAAA;EAEA;EAEA;IACA;EACA;EACAE;IACA;IACA;MACA;MACA;QACA;QACA;MACA;QACAC;MACA;IACA;IACA;IACA;MACA;QACA;QAEA,gDACA,6CACA;QACA;UACA;UACA;YACAC;cACAC;cACAC;cACAR;YACA;UACA;YACAS;UACA;QACA;QACA;UACA;YACAZ;UACA;UAEA;YACA;YACA;YACA;UACA;YACA;UACA;QACA;MACA;IACA;IAEA;IACA;MACA;QACAA;MACA;MACA;QACA;QACA;MACA;QACAS;UACAC;UACAC;UACAR;QACA;MACA;IACA;IACA;IACA;MACA;MACA;QACA;QACA;MACA;IACA;IACA;;IAEAU;MACA;MACA;IACA;IACAC;MACA;MACA;MACA;IACA;IACAC;MACA;IACA;IACAC;MACA;IACA;IACAC;MACA;MACA;IACA;EACA;AACA","names":["window","components","AdminSideBar","data","createDiscountForm","dialog","update_dialog","delete_dialog","loading","errorAlert","deleteDemo","updateDemo","createDemo","tableName","discountList","headers","text","align","sortable","value","methods","console","swal","icon","title","tableNameCheckByOK","deleteItem","editItem","closeUpdate","closeDelete","saveCancel"],"sourceRoot":"src/views","sources":["AdminDiscountView.vue"],"sourcesContent":["<template>\n  <div>\n    <AdminSideBar />\n    <v-data-table\n      :headers=\"headers\"\n      :items=\"discountList\"\n      :items-per-page=\"10\"\n      class=\"elevation-1\"\n    >\n      <template v-slot:top>\n        <v-toolbar flat>\n          <v-toolbar-title>Discount</v-toolbar-title>\n          <v-divider class=\"mx-4\" inset vertical></v-divider>\n\n          <!-- -------------****** create ******-------------------------- -->\n          <v-dialog v-model=\"dialog\" max-width=\"400px\">\n            <template v-slot:activator=\"{ on, attrs }\">\n              <v-btn\n                color=\"primary\"\n                class=\"mb-2 widthoutupercase white--text\"\n                v-bind=\"attrs\"\n                v-on=\"on\"\n              >\n                Add Discount\n              </v-btn>\n            </template>\n            <v-card>\n              <v-form ref=\"createDiscountForm\" v-model=\"createDiscountForm\">\n                <v-card-title>\n                  <h3>Add New Discount</h3>\n                </v-card-title>\n                <v-card-text>\n                  <v-container>\n                    <v-row>\n                      <v-col cols=\"12\" sm=\"7\" md=\"5\">\n                        <v-text-field\n                          v-model=\"createDemo.discountName\"\n                          label=\"Discount Name\"\n                          :rules=\"[\n                            (v) => !!v || 'Required',\n                            (v) =>\n                              (v && v.length <= 20) ||\n                              'Discount name must be less than 20 characters',\n                          ]\"\n                        ></v-text-field>\n                      </v-col>\n                    </v-row>\n                  </v-container>\n                </v-card-text>\n                <v-card-actions>\n                  <v-spacer></v-spacer>\n                  <v-btn class=\"mb-2 widthoutupercase\" text @click=\"saveCancel\"\n                    >Cancle\n                  </v-btn>\n                  <v-btn\n                    color=\"primary\"\n                    class=\"mb-2 widthoutupercase white--text\"\n                    @click=\"save\"\n                    :disabled=\"!createDiscountForm\"\n                  >\n                    save\n                  </v-btn>\n                </v-card-actions>\n              </v-form>\n            </v-card>\n          </v-dialog>\n        </v-toolbar>\n      </template>\n      <template v-slot:[`item.actions`]=\"{ item }\">\n        <v-icon color=\"indigo\" class=\"mr-2\" @click=\"editItem(item)\">\n          mdi-pencil\n        </v-icon>\n        <v-icon color=\"error\" @click=\"deleteItem(item)\"> mdi-delete </v-icon>\n      </template>\n      <template v-slot:[`item.createdAt`]=\"{ item }\">\n        {{ item.createdAt | formatLocalDate }}\n      </template>\n      <template v-slot:[`item.updatedAt`]=\"{ item }\">\n        {{ item.updatedAt | formatLocalDate }}\n      </template>\n    </v-data-table>\n    <v-toolbar>\n      <!-- -------------****** update ******-------------------------- -->\n      <v-form ref=\"createDiscountForm\" v-model=\"createDiscountForm\">\n        <v-dialog v-model=\"update_dialog\" max-width=\"400px\">\n          <v-card>\n            <v-card-title>\n              <h3>Edit Discount</h3>\n            </v-card-title>\n            <v-card-text>\n              <v-container>\n                <v-row>\n                  <v-col cols=\"12\" sm=\"7\" md=\"5\">\n                    <v-text-field\n                      v-model=\"updateDemo.discountName\"\n                      label=\"Table Name\"\n                      :rules=\"[\n                        (v) => !!v || 'Required',\n                        (v) =>\n                          (v && v.length <= 20) ||\n                          'Discount name must be less than 20 characters',\n                      ]\"\n                    ></v-text-field>\n                  </v-col>\n                </v-row>\n              </v-container>\n            </v-card-text>\n            <v-card-actions>\n              <v-spacer></v-spacer>\n              <v-btn class=\"mb-2 widthoutupercase\" text @click=\"closeUpdate\"\n                >Cancel</v-btn\n              >\n              <v-btn\n                color=\"primary\"\n                class=\"mb-2 widthoutupercase white--text\"\n                @click=\"updateItemConfirm(updateDemo.discountId)\"\n                :disabled=\"!createDiscountForm\"\n                >Update</v-btn\n              >\n            </v-card-actions>\n          </v-card>\n        </v-dialog>\n      </v-form>\n      <!-- -------------****** delete ******-------------------------- -->\n      <v-container>\n        <v-dialog v-model=\"delete_dialog\" max-width=\"400px\">\n          <v-card>\n            <v-card-title\n              ><span>Are you sure you want to delete this?</span></v-card-title\n            >\n\n            <v-card-actions>\n              <v-spacer></v-spacer>\n              <v-btn class=\"mb-2 widthoutupercase\" text @click=\"closeDelete\"\n                >Cancel</v-btn\n              >\n              <v-btn\n                color=\"primary\"\n                class=\"mb-2 widthoutupercase white--text\"\n                @click=\"deleteItemConfirm(deleteDemo.discountId)\"\n                >Delete</v-btn\n              >\n            </v-card-actions>\n          </v-card>\n        </v-dialog>\n      </v-container>\n    </v-toolbar>\n  </div>\n</template>\n\n<script>\nimport swal from \"sweetalert2\";\nwindow.swal = swal;\nimport utils from \"@/utils/utils\";\nimport AdminSideBar from \"@/components/AdminSideBar.vue\";\nexport default {\n  components: {\n    AdminSideBar,\n  },\n  data: () => ({\n    createDiscountForm: false,\n    dialog: false,\n    update_dialog: false,\n    delete_dialog: false,\n    loading: false,\n    errorAlert: false,\n    deleteDemo: {},\n    updateDemo: {},\n    createDemo: {\n      tableName: \"\",\n    },\n    discountList: [],\n    headers: [\n      {\n        text: \"ID\",\n        align: \"start\",\n        sortable: false,\n        value: \"discountId\",\n      },\n      { text: \"Table\", value: \"tableName\" },\n      { text: \"Created Date\", value: \"createdAt\" },\n      { text: \"Modified Date\", value: \"updatedAt\" },\n      { text: \"Actions\", value: \"actions\", sortable: false },\n    ],\n  }),\n\n  async created() {\n    await this.fetchAllDiscounts();\n  },\n  methods: {\n    // <!-- -------------****** get all table from utils.http ******-------------------------- -->\n    async fetchAllDiscounts() {\n      const response = await utils.http.get(\"/discount/list\");\n      if (response) {\n        const data = await response.json();\n        if (data) this.discountList = data;\n      } else {\n        console.log(\"sth wrong\");\n      }\n    },\n    // <!-- -------------****** save table from utils.http ******-------------------------- -->\n    async save() {\n      if (this.$refs.createDiscountForm.validate()) {\n        let tableNameCheckByOK = false;\n\n        const respTableNameCheck = await utils.http.get(\n          \"/table/\" + this.createDemo.tableName.trim()\n        );\n        if (respTableNameCheck && respTableNameCheck.status == 200) {\n          const data = await respTableNameCheck.json();\n          if (data && data == true) {\n            swal.fire({\n              icon: \"error\",\n              title: \"Sorry...\",\n              text: \"Table name already exists!\",\n            });\n          } else {\n            tableNameCheckByOK = true;\n          }\n        }\n        if (tableNameCheckByOK) {\n          const resp = await utils.http.post(\"/admin/table/create\", {\n            tableName: this.createDemo.tableName,\n          });\n\n          if (resp) {\n            await this.fetchAllTables();\n            this.dialog = false;\n            this.createDemo = {};\n          } else {\n            this.errorAlert = true;\n          }\n        }\n      }\n    },\n\n    // <!-- -------------****** update table from utils.http ******-------------------------- -->\n    async updateItemConfirm(id) {\n      const resp = await utils.http.put(\"/admin/table/update/\" + id, {\n        tableName: this.updateDemo.tableName,\n      });\n      if (resp && resp.status === 200) {\n        await this.fetchAllTables();\n        this.update_dialog = false;\n      } else {\n        swal.fire({\n          icon: \"error\",\n          title: \"Sorry...\",\n          text: \"Table cannot update!\",\n        });\n      }\n    },\n    // <!-- -------------****** delete table from utils.http ******-------------------------- -->\n    async deleteItemConfirm(id) {\n      const resp = await utils.http.del(\"/admin/table/delete/\" + id);\n      if (resp.status == 200) {\n        await this.fetchAllTables();\n        this.delete_dialog = false;\n      }\n    },\n    // <!-- -------------******  event handelar from dialog ******-------------------------- -->\n\n    deleteItem(item) {\n      this.delete_dialog = true;\n      this.deleteDemo = item;\n    },\n    editItem(item) {\n      this.update_dialog = true;\n      this.updateDemo = Object.assign({}, item);\n      this.tableName = this.updateDemo.tableName;\n    },\n    closeUpdate() {\n      this.update_dialog = false;\n    },\n    closeDelete() {\n      this.delete_dialog = false;\n    },\n    saveCancel() {\n      this.dialog = false;\n      this.createDemo = {};\n    },\n  },\n};\n</script>\n\n<style>\n.v-btn:hover {\n  background-color: primary;\n  color: white !important;\n}\n</style>\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}