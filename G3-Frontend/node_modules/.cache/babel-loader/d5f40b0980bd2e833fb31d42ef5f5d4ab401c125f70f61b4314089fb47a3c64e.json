{"ast":null,"code":"import swal from \"sweetalert2\";\nwindow.swal = swal;\nimport utils from \"@/utils/utils\";\nimport AdminSideBar from \"@/components/AdminSideBar.vue\";\nimport { mapState } from \"vuex\";\nexport default {\n  components: {\n    AdminSideBar\n  },\n  data: () => ({\n    createDiscountForm: false,\n    dialog: false,\n    discount_dialog: false,\n    update_dialog: false,\n    delete_dialog: false,\n    loading: false,\n    errorAlert: false,\n    chooseDiscountId: \"\",\n    deleteDemo: {},\n    updateDemo: {},\n    createDemo: {\n      discountName: \"\",\n      discountPercentage: 0\n    },\n    discountList: [],\n    headers: [{\n      text: \"ID\",\n      align: \"start\",\n      sortable: false,\n      value: \"discountId\"\n    }, {\n      text: \"Discount\",\n      value: \"discountName\"\n    }, {\n      text: \"Percentage\",\n      value: \"discountPercentage\"\n    }, {\n      text: \"Status\",\n      value: \"isActive\"\n    }, {\n      text: \"Created Date\",\n      value: \"createdAt\"\n    }, {\n      text: \"Modified Date\",\n      value: \"updatedAt\"\n    }, {\n      text: \"Actions\",\n      value: \"actions\",\n      sortable: false\n    }]\n  }),\n  async created() {\n    await this.fetchAllDiscounts();\n    await this.fetchActiveDiscount();\n    // await this.fetchMakeDiscountOFF();\n    //await this.fetchDiscountOn();\n  },\n\n  computed: {\n    ...mapState([\"discount\"])\n  },\n  methods: {\n    // <!-- -------------****** get all discount from utils.http ******-------------------------- -->\n    async fetchAllDiscounts() {\n      const response = await utils.http.get(\"/discount/list\");\n      if (response) {\n        const data = await response.json();\n        if (data) this.discountList = data;\n      } else {\n        console.log(\"sth wrong\");\n      }\n    },\n    // <!-- -------------****** update user from utils.http ******-------------------------- -->\n    async updateDiscountStatus(chooseDiscountId) {\n      this.fetchMakeDiscountOFF();\n      const resp = await utils.http.put(\"/admin/discount/update_active/\" + chooseDiscountId, {\n        discountId: this.chooseDiscountId\n      });\n      if (resp && resp.status === 200) {\n        this.discount_dialog = false;\n        this.$router.go(); // current page refresh\n      }\n    },\n\n    async fetchMakeDiscountOFF() {\n      const resp = await utils.http.put(\"/admin/discount/update_unactive\");\n      if (resp && resp.status == 200) {\n        console.log(resp);\n      }\n    },\n    async fetchActiveDiscount() {\n      const response = await utils.http.get(\"/discount/active\");\n      if (response.status === 200) {\n        const data = await response.json();\n        if (data) {\n          this.$store.commit(\"discount\", data);\n        }\n      }\n    },\n    // <!-- -------------****** save discount from utils.http ******-------------------------- -->\n    async save() {\n      if (this.$refs.createDiscountForm.validate()) {\n        let discountNameCheckByOK = false;\n        const respdiscountNameCheck = await utils.http.get(\"/discount/discountName/\" + this.createDemo.discountName.trim());\n        if (respdiscountNameCheck && respdiscountNameCheck.status == 200) {\n          const data = await respdiscountNameCheck.json();\n          if (data && data == true) {\n            swal.fire({\n              icon: \"error\",\n              title: \"Sorry...\",\n              text: \"Discount name already exists!\"\n            });\n          } else {\n            discountNameCheckByOK = true;\n          }\n        }\n        if (discountNameCheckByOK) {\n          const resp = await utils.http.post(\"/admin/discount/create\", {\n            discountName: this.createDemo.discountName,\n            discountPercentage: this.createDemo.discountPercentage\n          });\n          if (resp) {\n            await this.fetchAllDiscounts();\n            this.dialog = false;\n            this.createDemo = {};\n          } else {\n            this.errorAlert = true;\n          }\n        }\n      }\n    },\n    // <!-- -------------****** update discount from utils.http ******-------------------------- -->\n    async updateItemConfirm(id) {\n      const resp = await utils.http.put(\"/admin/discount/update/\" + id, {\n        discountName: this.updateDemo.discountName,\n        discountPercentage: this.updateDemo.discountPercentage\n      });\n      if (resp && resp.status === 200) {\n        await this.fetchAllDiscounts();\n        this.update_dialog = false;\n      } else {\n        swal.fire({\n          icon: \"error\",\n          title: \"Sorry...\",\n          text: \"Discount name already exists!\"\n        });\n      }\n    },\n    // <!-- -------------****** delete discount from utils.http ******-------------------------- -->\n    async deleteItemConfirm(id) {\n      const resp = await utils.http.del(\"/admin/discount/delete/\" + id);\n      if (resp.status == 200) {\n        await this.fetchAllDiscounts();\n        this.delete_dialog = false;\n      }\n    },\n    // <!-- -------------******  event handelar from dialog ******-------------------------- -->\n    removeDiscount() {\n      this.fetchMakeDiscountOFF();\n      this.$store.commit(\"discount\");\n      this.discount_dialog = false;\n      this.$router.go();\n    },\n    deleteItem(item) {\n      this.delete_dialog = true;\n      this.deleteDemo = item;\n    },\n    editItem(item) {\n      this.update_dialog = true;\n      this.updateDemo = Object.assign({}, item);\n      this.discountName = this.updateDemo.discountName;\n      this.discountPercentage = this.updateDemo.discountPercentage;\n    },\n    closeUpdate() {\n      this.update_dialog = false;\n    },\n    closeDelete() {\n      this.delete_dialog = false;\n    },\n    closeDiscount() {\n      this.discount_dialog = false;\n    },\n    saveCancel() {\n      this.dialog = false;\n      this.createDemo = {};\n    }\n  }\n};","map":{"version":3,"mappings":"AAmSA;AACAA;AACA;AACA;AACA;AACA;EACAC;IACAC;EACA;EACAC;IACAC;IACAC;IACAC;IACAC;IACAC;IACAC;IACAC;IACAC;IACAC;IACAC;IACAC;MACAC;MACAC;IACA;IACAC;IACAC,UACA;MACAC;MACAC;MACAC;MACAC;IACA,GACA;MAAAH;MAAAG;IAAA,GACA;MAAAH;MAAAG;IAAA,GACA;MAAAH;MAAAG;IAAA,GACA;MAAAH;MAAAG;IAAA,GACA;MAAAH;MAAAG;IAAA,GACA;MAAAH;MAAAG;MAAAD;IAAA;EAEA;EAEA;IACA;IACA;IACA;IACA;EACA;;EACAE;IACA;EACA;EAEAC;IACA;IACA;MACA;MACA;QACA;QACA;MACA;QACAC;MACA;IACA;IACA;IACA;MACA;MACA,kCACA,qDACA;QACAC;MACA,EACA;MAEA;QACA;QACA;MACA;IACA;;IACA;MACA;MACA;QACAD;MACA;IACA;IACA;MACA;MAEA;QACA;QACA;UACA;QACA;MACA;IACA;IAEA;IACA;MACA;QACA;QAEA,mDACA,gEACA;QACA;UACA;UACA;YACAE;cACAC;cACAC;cACAV;YACA;UACA;YACAW;UACA;QACA;QACA;UACA;YACAf;YACAC;UACA;UAEA;YACA;YACA;YACA;UACA;YACA;UACA;QACA;MACA;IACA;IAEA;IACA;MACA;QACAD;QACAC;MACA;MACA;QACA;QACA;MACA;QACAW;UACAC;UACAC;UACAV;QACA;MACA;IACA;IACA;IACA;MACA;MACA;QACA;QACA;MACA;IACA;IACA;IACAY;MACA;MACA;MACA;MACA;IACA;IACAC;MACA;MACA;IACA;IACAC;MACA;MACA;MACA;MACA;IACA;IACAC;MACA;IACA;IACAC;MACA;IACA;IACAC;MACA;IACA;IACAC;MACA;MACA;IACA;EACA;AACA","names":["window","components","AdminSideBar","data","createDiscountForm","dialog","discount_dialog","update_dialog","delete_dialog","loading","errorAlert","chooseDiscountId","deleteDemo","updateDemo","createDemo","discountName","discountPercentage","discountList","headers","text","align","sortable","value","computed","methods","console","discountId","swal","icon","title","discountNameCheckByOK","removeDiscount","deleteItem","editItem","closeUpdate","closeDelete","closeDiscount","saveCancel"],"sourceRoot":"src/views","sources":["AdminDiscountView.vue"],"sourcesContent":["<template>\n  <div>\n    <AdminSideBar />\n    <template>\n      <v-card>\n        <v-card-title>\n          <v-dialog v-model=\"discount_dialog\" max-width=\"400px\">\n            <template v-slot:activator=\"{ on, attrs }\">\n              <v-row class=\"ml-1 mt-1\">\n                <v-btn\n                  class=\"mr-2\"\n                  v-bind=\"attrs\"\n                  v-on=\"on\"\n                  tile\n                  color=\"#F6EFEF\"\n                >\n                  <v-icon left> discount </v-icon>\n                  Set Discount\n                </v-btn>\n                <v-btn @click=\"removeDiscount()\" tile color=\"#F6EFEF\">\n                  <v-icon left> delete </v-icon>\n                  Remove Discount\n                </v-btn>\n              </v-row>\n            </template>\n            <v-card>\n              <v-card-title>\n                <h3>Set Discount</h3>\n              </v-card-title>\n              <v-card-text>\n                <v-container>\n                  <v-row>\n                    <v-col cols=\"12\" sm=\"6\" md=\"12\">\n                      <!-- Category -->\n\n                      <v-select\n                        v-model=\"chooseDiscountId\"\n                        :items=\"discountList\"\n                        item-text=\"discountName\"\n                        item-value=\"discountId\"\n                        :rules=\"[(v) => !!v || 'Required']\"\n                        label=\"Discount\"\n                        required\n                      >\n                      </v-select>\n                    </v-col>\n                  </v-row>\n                </v-container>\n              </v-card-text>\n              <v-card-actions>\n                <v-spacer></v-spacer>\n\n                <v-btn\n                  class=\"mb-2 widthoutupercase\"\n                  text\n                  @click=\"closeDiscount()\"\n                  >Cancle\n                </v-btn>\n                <v-btn\n                  color=\"primary\"\n                  class=\"mb-2 widthoutupercase white--text\"\n                  @click.prevent=\"updateDiscountStatus(chooseDiscountId)\"\n                >\n                  Confirm\n                </v-btn>\n              </v-card-actions>\n            </v-card>\n          </v-dialog>\n        </v-card-title>\n\n        <v-card-subtitle class=\"mt-3\" v-if=\"discount.isActive == true\">\n          <strong\n            >Today, We set\n            <strong class=\"primary--text\">\n              \" {{ discount.discountName }} -\n              {{ discount.discountPercentage }}%\"\n            </strong>\n            Discount!</strong\n          >\n        </v-card-subtitle>\n        <v-card-subtitle class=\"mt-3\" v-else>\n          <strong>Today, We don't have Discount!</strong>\n        </v-card-subtitle>\n        <v-data-table\n          :headers=\"headers\"\n          :items=\"discountList\"\n          :items-per-page=\"10\"\n          class=\"elevation-1\"\n        >\n          <template v-slot:top>\n            <v-toolbar flat>\n              <v-toolbar-title>Discount</v-toolbar-title>\n              <v-divider class=\"mx-4\" inset vertical></v-divider>\n\n              <!-- -------------****** create ******-------------------------- -->\n              <v-dialog v-model=\"dialog\" max-width=\"400px\">\n                <template v-slot:activator=\"{ on, attrs }\">\n                  <v-btn\n                    color=\"primary\"\n                    class=\"mb-2 widthoutupercase white--text\"\n                    v-bind=\"attrs\"\n                    v-on=\"on\"\n                  >\n                    Add Discount\n                  </v-btn>\n                </template>\n                <v-card>\n                  <v-form ref=\"createDiscountForm\" v-model=\"createDiscountForm\">\n                    <v-card-title>\n                      <h3>Add New Discount</h3>\n                    </v-card-title>\n                    <v-card-text>\n                      <v-container>\n                        <v-row>\n                          <v-col cols=\"12\" sm=\"12\" md=\"6\">\n                            <v-text-field\n                              v-model=\"createDemo.discountName\"\n                              label=\"Discount Name\"\n                              :rules=\"[\n                                (v) => !!v || 'Required',\n                                (v) =>\n                                  (v && v.length <= 20) ||\n                                  'Discount name must be less than 20 characters',\n                              ]\"\n                            ></v-text-field>\n                          </v-col>\n                          <v-col class=\"d-flex\" cols=\"12\" sm=\"6\">\n                            <v-text-field\n                              v-model=\"createDemo.discountPercentage\"\n                              type=\"number\"\n                              suffix=\"%\"\n                              :rules=\"[\n                                (v) => !!v || 'Required',\n                                (v) =>\n                                  (v && v > 0) ||\n                                  'Percentage must be greater than 0 %',\n                              ]\"\n                              label=\"Percentage\"\n                              required\n                            ></v-text-field>\n                          </v-col>\n                        </v-row>\n                        <v-row>\n                          <v-col class=\"d-flex\" cols=\"12\" sm=\"6\">\n                            <v-text-field\n                              v-model=\"createDemo.discountPercentage\"\n                              type=\"number\"\n                              suffix=\"%\"\n                              :rules=\"[\n                                (v) => !!v || 'Required',\n                                (v) =>\n                                  (v && v > 0) ||\n                                  'Percentage must be greater than 0 %',\n                              ]\"\n                              label=\"Percentage\"\n                              required\n                            ></v-text-field>\n                          </v-col>\n                        </v-row>\n                      </v-container>\n                    </v-card-text>\n                    <v-card-actions>\n                      <v-spacer></v-spacer>\n                      <v-btn\n                        class=\"mb-2 widthoutupercase\"\n                        text\n                        @click=\"saveCancel\"\n                        >Cancle\n                      </v-btn>\n                      <v-btn\n                        color=\"primary\"\n                        class=\"mb-2 widthoutupercase white--text\"\n                        @click=\"save\"\n                        :disabled=\"!createDiscountForm\"\n                      >\n                        save\n                      </v-btn>\n                    </v-card-actions>\n                  </v-form>\n                </v-card>\n              </v-dialog>\n            </v-toolbar>\n          </template>\n          <template v-slot:[`item.actions`]=\"{ item }\">\n            <v-icon color=\"indigo\" class=\"mr-2\" @click=\"editItem(item)\">\n              mdi-pencil\n            </v-icon>\n            <v-icon color=\"error\" @click=\"deleteItem(item)\">\n              mdi-delete\n            </v-icon>\n          </template>\n          <template v-slot:[`item.isActive`]=\"{ item }\">\n            {{ item.isActive == true ? \"ON\" : \"OFF\" }}\n          </template>\n          <template v-slot:[`item.createdAt`]=\"{ item }\">\n            {{ item.createdAt | formatLocalDate }}\n          </template>\n          <template v-slot:[`item.updatedAt`]=\"{ item }\">\n            {{ item.updatedAt | formatLocalDate }}\n          </template>\n        </v-data-table>\n      </v-card>\n\n      <v-toolbar>\n        <!-- -------------****** update ******-------------------------- -->\n        <v-form ref=\"createDiscountForm\" v-model=\"createDiscountForm\">\n          <v-dialog v-model=\"update_dialog\" max-width=\"400px\">\n            <v-card>\n              <v-card-title>\n                <h3>Edit Discount</h3>\n              </v-card-title>\n              <v-card-text>\n                <v-container>\n                  <v-row>\n                    <v-col cols=\"12\" sm=\"12\" md=\"6\">\n                      <v-text-field\n                        v-model=\"updateDemo.discountName\"\n                        label=\"Discount Name\"\n                        :rules=\"[\n                          (v) => !!v || 'Required',\n                          (v) =>\n                            (v && v.length <= 20) ||\n                            'Discount name must be less than 20 characters',\n                        ]\"\n                      ></v-text-field>\n                    </v-col>\n                    <v-col class=\"d-flex\" cols=\"12\" sm=\"6\">\n                      <v-text-field\n                        v-model=\"updateDemo.discountPercentage\"\n                        type=\"number\"\n                        suffix=\"%\"\n                        :rules=\"[\n                          (v) => !!v || 'Required',\n                          (v) =>\n                            (v && v > 0) ||\n                            'Percentage must be greater than 0 %',\n                        ]\"\n                        label=\"Percentage\"\n                        required\n                      ></v-text-field>\n                    </v-col>\n                  </v-row>\n                </v-container>\n              </v-card-text>\n              <v-card-actions>\n                <v-spacer></v-spacer>\n                <v-btn class=\"mb-2 widthoutupercase\" text @click=\"closeUpdate\"\n                  >Cancel</v-btn\n                >\n                <v-btn\n                  color=\"primary\"\n                  class=\"mb-2 widthoutupercase white--text\"\n                  @click=\"updateItemConfirm(updateDemo.discountId)\"\n                  :disabled=\"!createDiscountForm\"\n                  >Update</v-btn\n                >\n              </v-card-actions>\n            </v-card>\n          </v-dialog>\n        </v-form>\n        <!-- -------------****** delete ******-------------------------- -->\n        <v-container>\n          <v-dialog v-model=\"delete_dialog\" max-width=\"400px\">\n            <v-card>\n              <v-card-title\n                ><span\n                  >Are you sure you want to delete this?</span\n                ></v-card-title\n              >\n\n              <v-card-actions>\n                <v-spacer></v-spacer>\n                <v-btn class=\"mb-2 widthoutupercase\" text @click=\"closeDelete\"\n                  >Cancel</v-btn\n                >\n                <v-btn\n                  color=\"primary\"\n                  class=\"mb-2 widthoutupercase white--text\"\n                  @click=\"deleteItemConfirm(deleteDemo.discountId)\"\n                  >Delete</v-btn\n                >\n              </v-card-actions>\n            </v-card>\n          </v-dialog>\n        </v-container>\n      </v-toolbar>\n    </template>\n  </div>\n</template>\n\n<script>\nimport swal from \"sweetalert2\";\nwindow.swal = swal;\nimport utils from \"@/utils/utils\";\nimport AdminSideBar from \"@/components/AdminSideBar.vue\";\nimport { mapState } from \"vuex\";\nexport default {\n  components: {\n    AdminSideBar,\n  },\n  data: () => ({\n    createDiscountForm: false,\n    dialog: false,\n    discount_dialog: false,\n    update_dialog: false,\n    delete_dialog: false,\n    loading: false,\n    errorAlert: false,\n    chooseDiscountId: \"\",\n    deleteDemo: {},\n    updateDemo: {},\n    createDemo: {\n      discountName: \"\",\n      discountPercentage: 0,\n    },\n    discountList: [],\n    headers: [\n      {\n        text: \"ID\",\n        align: \"start\",\n        sortable: false,\n        value: \"discountId\",\n      },\n      { text: \"Discount\", value: \"discountName\" },\n      { text: \"Percentage\", value: \"discountPercentage\" },\n      { text: \"Status\", value: \"isActive\" },\n      { text: \"Created Date\", value: \"createdAt\" },\n      { text: \"Modified Date\", value: \"updatedAt\" },\n      { text: \"Actions\", value: \"actions\", sortable: false },\n    ],\n  }),\n\n  async created() {\n    await this.fetchAllDiscounts();\n    await this.fetchActiveDiscount();\n    // await this.fetchMakeDiscountOFF();\n    //await this.fetchDiscountOn();\n  },\n  computed: {\n    ...mapState([\"discount\"]),\n  },\n\n  methods: {\n    // <!-- -------------****** get all discount from utils.http ******-------------------------- -->\n    async fetchAllDiscounts() {\n      const response = await utils.http.get(\"/discount/list\");\n      if (response) {\n        const data = await response.json();\n        if (data) this.discountList = data;\n      } else {\n        console.log(\"sth wrong\");\n      }\n    },\n    // <!-- -------------****** update user from utils.http ******-------------------------- -->\n    async updateDiscountStatus(chooseDiscountId) {\n      this.fetchMakeDiscountOFF();\n      const resp = await utils.http.put(\n        \"/admin/discount/update_active/\" + chooseDiscountId,\n        {\n          discountId: this.chooseDiscountId,\n        }\n      );\n\n      if (resp && resp.status === 200) {\n        this.discount_dialog = false;\n        this.$router.go(); // current page refresh\n      }\n    },\n    async fetchMakeDiscountOFF() {\n      const resp = await utils.http.put(\"/admin/discount/update_unactive\");\n      if (resp && resp.status == 200) {\n        console.log(resp);\n      }\n    },\n    async fetchActiveDiscount() {\n      const response = await utils.http.get(\"/discount/active\");\n\n      if (response.status === 200) {\n        const data = await response.json();\n        if (data) {\n          this.$store.commit(\"discount\", data);\n        }\n      }\n    },\n\n    // <!-- -------------****** save discount from utils.http ******-------------------------- -->\n    async save() {\n      if (this.$refs.createDiscountForm.validate()) {\n        let discountNameCheckByOK = false;\n\n        const respdiscountNameCheck = await utils.http.get(\n          \"/discount/discountName/\" + this.createDemo.discountName.trim()\n        );\n        if (respdiscountNameCheck && respdiscountNameCheck.status == 200) {\n          const data = await respdiscountNameCheck.json();\n          if (data && data == true) {\n            swal.fire({\n              icon: \"error\",\n              title: \"Sorry...\",\n              text: \"Discount name already exists!\",\n            });\n          } else {\n            discountNameCheckByOK = true;\n          }\n        }\n        if (discountNameCheckByOK) {\n          const resp = await utils.http.post(\"/admin/discount/create\", {\n            discountName: this.createDemo.discountName,\n            discountPercentage: this.createDemo.discountPercentage,\n          });\n\n          if (resp) {\n            await this.fetchAllDiscounts();\n            this.dialog = false;\n            this.createDemo = {};\n          } else {\n            this.errorAlert = true;\n          }\n        }\n      }\n    },\n\n    // <!-- -------------****** update discount from utils.http ******-------------------------- -->\n    async updateItemConfirm(id) {\n      const resp = await utils.http.put(\"/admin/discount/update/\" + id, {\n        discountName: this.updateDemo.discountName,\n        discountPercentage: this.updateDemo.discountPercentage,\n      });\n      if (resp && resp.status === 200) {\n        await this.fetchAllDiscounts();\n        this.update_dialog = false;\n      } else {\n        swal.fire({\n          icon: \"error\",\n          title: \"Sorry...\",\n          text: \"Discount name already exists!\",\n        });\n      }\n    },\n    // <!-- -------------****** delete discount from utils.http ******-------------------------- -->\n    async deleteItemConfirm(id) {\n      const resp = await utils.http.del(\"/admin/discount/delete/\" + id);\n      if (resp.status == 200) {\n        await this.fetchAllDiscounts();\n        this.delete_dialog = false;\n      }\n    },\n    // <!-- -------------******  event handelar from dialog ******-------------------------- -->\n    removeDiscount() {\n      this.fetchMakeDiscountOFF();\n      this.$store.commit(\"discount\");\n      this.discount_dialog = false;\n      this.$router.go();\n    },\n    deleteItem(item) {\n      this.delete_dialog = true;\n      this.deleteDemo = item;\n    },\n    editItem(item) {\n      this.update_dialog = true;\n      this.updateDemo = Object.assign({}, item);\n      this.discountName = this.updateDemo.discountName;\n      this.discountPercentage = this.updateDemo.discountPercentage;\n    },\n    closeUpdate() {\n      this.update_dialog = false;\n    },\n    closeDelete() {\n      this.delete_dialog = false;\n    },\n    closeDiscount() {\n      this.discount_dialog = false;\n    },\n    saveCancel() {\n      this.dialog = false;\n      this.createDemo = {};\n    },\n  },\n};\n</script>\n\n<style>\n.v-btn:hover {\n  background-color: primary;\n  color: white !important;\n}\n</style>\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}